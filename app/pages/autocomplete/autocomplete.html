<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>AutoComplete Test</title>
    <style type="text/css">
        input {
            width: 100%;
        }

        #AutoComponent, p {
            margin: auto;
            padding: 0;
            width: 50%;
        }

        p {
            padding: 2em;
        }
    </style>
    <script type="text/javascript" src="autocomplete.js"></script>
    <script type="text/javascript">
      ((root) => {
        // async call to retrieve JSON
        root.getJSON = function (url) {
          return new Promise(function (resolve, reject) {
            const xhr = new XMLHttpRequest();
            xhr.overrideMimeType("application/json");
            xhr.open('get', url, true);
            xhr.onreadystatechange  = function () {
              const status = xhr.status;
              if (status === "200" && xhr.readyState === 4) {
                resolve(xhr.response);
              } else {
                reject(status);
              }
            };
            xhr.send(null);
          });
        };
      })(window);
    </script>
</head>
<body>
<h1>AutoComplete</h1>
<div id="main">
    <div id="AutoComponent">
        <input type="text"
               id="inputName"
               title="Begin Typing Name"
               placeholder="Begin Typing Name"/>
    </div>
    <p id="results"></p>
</div>
<script language="javascript">
  ((root) => {
    getJSON('MOCK_DATA_1000.json').then((data) => {
      data = JSON.parse(data);
      root.console.info('Returned', data.length);
      const autoInput = new AutoComplete(document.getElementById('inputName'), data);
        autoInput.AddEventCallback((data) => {
          if(!data) return;
          root.console.info('Item Selected', data);
          const p = document.getElementById('results');
          p.innerHTML = `<i>Selection</i>: <b>${data.label}</b> [${data.value}]`;
        })
    }, (status) => {
      const msg = 'Got a problem, OOPS';
      root.console.error(msg, status);
    });

  })(window);
</script>
</body>
</html>
